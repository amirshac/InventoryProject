package inventory.DBservice;

import java.io.FileWriter;
import java.io.IOException;
import java.util.Map;
import java.util.UUID;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;

import inventory.models.Device;
import inventory.models.IOTThing;
import mockDB.MockDB;

public class MockDBService {
	private MockDB db;
	private Map<UUID, Device> deviceMap;
	private Map<UUID, IOTThing> iotMap;
	
	public MockDBService() {
		db = MockDB.getInstance();
		deviceMap = db.getDeviceMap();
		iotMap = db.getIOTMap();
	}
	
	public Map<UUID, Device> getAllDevices(){
		return deviceMap;
	}
	
	public synchronized void saveDBtoFile() {
		String fileNameDevices = "files/MockDBDevices.json";
		String fileNameIot = "files/MockDBiot.json";
		
		GsonBuilder gsonBuilder = new GsonBuilder();
		gsonBuilder = gsonBuilder.setPrettyPrinting();   //Sets pretty formatting
		Gson gson = gsonBuilder.create();                //Create Gson reference
		
		try (FileWriter writer = new FileWriter(fileNameDevices)){
			gson.toJson(deviceMap, writer);
		} catch (IOException e) {
			e.printStackTrace();
		}
		
		try (FileWriter writer = new FileWriter(fileNameIot)){
			gson.toJson(iotMap, writer);
		} catch (IOException e) {
			e.printStackTrace();
		}
		
	}
}
